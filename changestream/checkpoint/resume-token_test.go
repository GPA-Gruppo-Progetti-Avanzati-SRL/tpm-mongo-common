package checkpoint_test

import (
	"encoding/json"
	"github.com/GPA-Gruppo-Progetti-Avanzati-SRL/tpm-mongo-common/changestream/checkpoint"
	"github.com/stretchr/testify/require"
	"testing"
)

func TestParse(t *testing.T) {

	rtArr := []string{
		"8267C867A3000000012B0429296E1404",
		"8267C867B3000000022B0429296E1404",
		"8267C867A2000000172B042C0100296E5A1004D3284E04D8914467A2160201812E4C4C463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467C867A2FB1CBCD579F4E4D9000004",
		"8267C85AF1000000042B0429296E1404",

		"8267C867A2000000192B042C0100296E5A1004D3284E04D8914467A2160201812E4C4C463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467C867A2FB1CBCD579F4E4DE000004",
		//"8263515979000000022B0429296E1404",
		//"8267C867A2000000172B042C0100296E5A1004D3284E04D8914467A2160201812E4C4C463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467C867A2FB1CBCD579F4E4D9000004",
		//"8267C867A2000000172B042C0100296E5A1004D3284E04D8914467A2160201812E4C4C463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467C867A2FB1CBCD579F4E4D9000004",
		//"8267C86B71000000012B0429296E1404",
		//"8267C86B71000000022B042C0100296E5A1004D3284E04D8914467A2160201812E4C4C463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467C86B71FB1CBCD579F54E18000004",
		//"8267C86B72000000062B0429296E1404",
		//"8267C86E09000000012B0429296E1404",
		//"8267C86F3B000000012B042C0100296E5A1004D3284E04D8914467A2160201812E4C4C463C6F7065726174696F6E54797065003C696E736572740046646F63756D656E744B65790046645F6964006467C86F3BFB1CBCD579F5A67E000004",
	}

	for _, s := range rtArr {
		rt1 := checkpoint.ResumeToken{Value: s}
		rtInfo, err := rt1.Parse()
		require.NoError(t, err)
		b, err := json.Marshal(rtInfo)
		require.NoError(t, err)
		t.Log(string(b))
	}

}
